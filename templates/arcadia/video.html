{% load static %}

<!-- =======================
  Arcadia Video Section (hero with play button)
======================== -->
<section class="section-video parallax100" style="background-image: url('{% static "arcadia/images/bg-cover-video-02.jpg" %}');">
  <div class="content-video t-center p-t-225 p-b-250">
    <span class="tit2 p-l-15 p-r-15">Discover</span>

    <h3 class="tit4 t-center p-l-15 p-r-15 p-t-3">Our Video</h3>

    <!-- Play Button (opens modal) -->
    <div class="btn-play ab-center size16 hov-pointer m-l-r-auto m-t-43 m-b-33"
         data-bs-toggle="modal" data-bs-target="#modal-video-01" aria-controls="modal-video-01">
      <div class="flex-c-m sizefull bo-cir bgwhite color1 hov1 trans-0-4">
        <i class="fa fa-play fs-18 m-l-2" aria-hidden="true"></i>
      </div>
    </div>
  </div>
</section>

<!-- =======================
  Bootstrap Modal for Video
======================== -->
<div class="modal fade" id="modal-video-01" tabindex="-1" aria-labelledby="videoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content bg-transparent border-0 position-relative">

      <!-- Close Button -->
      <button type="button" class="btn-close btn-close-white position-absolute end-0 top-0 m-3"
              data-bs-dismiss="modal" aria-label="Close"></button>

      <!-- Video Player (NO autoplay here) -->
      <div class="modal-body p-0">
        <div class="ratio ratio-16x9">
          <video id="arcadiaVideo" class="w-100 rounded-3 shadow-lg" controls preload="none" playsinline>
            <!-- ⭐ CHANGED: preload=none and NO autoplay -->
            <source src="{% static 'arcadia/videos/arcadia_video.mp4' %}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- =======================
  JS: play when modal opens, pause+reset when modal closes
======================== -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  const videoModal = document.getElementById('modal-video-01');
  const video = document.getElementById('arcadiaVideo');

  if (!videoModal || !video) return;

  // ⭐ CHANGED: play when modal is shown
  videoModal.addEventListener('shown.bs.modal', function () {
    // play only when user explicitly opens modal
    video.play().catch(() => {
      // autoplay might be blocked by browser; user will click play if needed
    });
  });

  // Pause & reset when hidden
  videoModal.addEventListener('hidden.bs.modal', function () {
    video.pause();
    video.currentTime = 0;
  });
});
</script>

<!-- Styles to ensure modal video is visible above overlay -->
<style>
#arcadiaVideo {
  display: block !important;
  position: relative;
  z-index: 1055;           /* above modal backdrop */
  background-color: black; /* fixes transparency issue */
}
.modal-content {
  background: rgba(0,0,0,0.9); /* darken background behind video */
}
</style>
